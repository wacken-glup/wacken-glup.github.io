import{k as b,y as U,P as A,_ as L,c,b as $,a as e,m as u,t as l,B as C,C as D,s,x as w,F as O,r as v,o as r}from"./index-B32Ib1Z1.js";const I={data(){return{loaded:!1,openSpaceLeaveConfirmDialog:!1,openSignOutConfirmDialog:!1,openDeleteAccountConfirmDialog:!1,openReauthenticateDialog:!1,openShareInviteDialog:!1,form:{name:"",nameTimeout:0},inviteUrl:""}},methods:{async signOut(n=!1){var t;if(!n&&((t=this.$ctx.currentUser.value)!=null&&t.isAnonymous)){this.openSignOutConfirmDialog=!0;return}await this.$ctx.auth.signOut(),window.location.reload()},async deleteAccount(n=!1){if(!n){this.openDeleteAccountConfirmDialog=!0;return}try{await this.$client.deleteAccount()}catch(t){if(t.code=="auth/requires-recent-login"){this.openReauthenticateDialog=!0,await this.$ctx.auth.signOut(),window.location.reload();return}console.error(t)}},invite(){var t;let n=this.$client.space.generateInvite(this.$t);console.info("share data",n),(t=navigator==null?void 0:navigator.share)==null||t.call(navigator,n),this.inviteUrl=this.$client.space.generateInvite(this.$t).url,this.openShareInviteDialog=!0},async inviteReset(){await this.$client.space.resetInvite(),this.inviteUrl=this.$client.space.generateInvite(this.$t).url},leaveSpace(n=!1){if(!n){this.openSpaceLeaveConfirmDialog=!0;return}this.$client.leaveSpace()}},mounted(){var n;this.form.name=((n=this.$client.space)==null?void 0:n.name)||"",(async()=>{var t;for(;((t=this.$client.space)==null?void 0:t.loaded)!=!0;)await b(50);this.loaded=!0})()},watch:{"form.name"(){var n;((n=this.$client.space)==null?void 0:n.name)!=this.form.name&&(clearTimeout(this.form.nameTimeout),this.form.nameTimeout=setTimeout(()=>{this.$client.space.updateName(this.form.name)},1e3))},"$client.space"(){var n;this.form.name=((n=this.$client.space)==null?void 0:n.name)||"",this.inviteUrl=this.$client.space.generateInvite(this.$t).url},inviteUrl(){let n=this.$client.space.generateInvite(this.$t).url;this.inviteUrl!=n&&(this.inviteUrl=n)}},components:{AppBar:U,PrivacyPolicyLink:A}},B={class:"responsive"},R={key:0,class:"center-align",style:{height:"100%",display:"flex","flex-direction":"column"}},P={class:"medium center middle-align center-align",style:{"min-width":"300px"}},_={key:0,class:"extra"},T=["src"],V={class:"center-align"},N={class:"link small-text"},q=e("div",{class:"space"},null,-1),F={class:"center-align"},z=e("i",null,"logout",-1),E=e("i",null,"delete",-1),M={key:0,class:"medium center middle-align center-align"},j=e("i",{class:"extra"},"tune",-1),G={class:"center-align"},H={class:"field label prefix border"},J=e("i",null,"label",-1),K={class:"center-align"},Q=e("i",null,"share",-1),W=e("i",null,"restore",-1),X=[W],Y={key:1,class:"medium center middle-align center-align"},Z=e("i",{class:"extra"},"groups",-1),x={class:"center-align"},ee={class:"center-align"},ne=e("i",null,"logout",-1),te={class:"right-align no-space"},ie=e("div",{class:"space"},null,-1),le={class:"right-align no-space"},oe=e("div",{class:"space"},null,-1),se={class:"right-align no-space"},ae=e("div",{class:"space"},null,-1),re={class:"right-align no-space"},ce=e("div",{class:"space"},null,-1),ue={class:"field label prefix border"},ve=e("i",null,"link",-1),ge={class:"right-align no-space"};function me(n,t,pe,de,i,a){var g,m,p,d,f,h;const k=v("AppBar"),y=v("PrivacyPolicyLink"),S=v("vue-qrcode");return r(),c(O,null,[$(k,{label:n.$t("navigation.settings")},null,8,["label"]),e("main",B,[n.$ctx.currentUser.value!=null?(r(),c("div",R,[e("article",P,[e("div",null,[n.$ctx.currentUser.value.photoURL==null?(r(),c("i",_,"person")):u("",!0),n.$ctx.currentUser.value.photoURL!=null?(r(),c("img",{key:1,class:"circle large",src:n.$ctx.currentUser.value.photoURL,referrerpolicy:"no-referrer"},null,8,T)):u("",!0),e("h5",V,l(n.$t("common.greeting"))+" "+l(((m=(g=n.$client.space)==null?void 0:g.self)==null?void 0:m.name)||(n.$ctx.currentUser.value.isAnonymous?n.$t("common.anon"):n.$ctx.currentUser.value.displayName)),1),e("span",N,l(n.$ctx.currentUser.value.email||n.$ctx.currentUser.value.uid),1),q,e("nav",F,[e("button",{class:"large",onClick:t[0]||(t[0]=o=>a.signOut())},[z,e("span",null,l(n.$t("common.logOut")),1)]),e("button",{class:"large error",onClick:t[1]||(t[1]=o=>a.deleteAccount())},[E,e("span",null,l(n.$t("common.delete")),1)])])])]),i.loaded&&((d=(p=n.$client.space)==null?void 0:p.self)!=null&&d.isOwner())?(r(),c("article",M,[e("div",null,[j,e("h5",G,l(n.$t("settings.spaceSettings.title")),1),e("div",H,[J,C(e("input",{type:"name","onUpdate:modelValue":t[2]||(t[2]=o=>i.form.name=o)},null,512),[[D,i.form.name]]),e("label",null,l(n.$t("common.name")),1)]),e("nav",K,[e("button",{class:"large",onClick:t[3]||(t[3]=o=>a.invite())},[Q,e("span",null,l(n.$t("common.invite")),1)]),e("button",{class:"circle large error",onClick:t[4]||(t[4]=o=>a.inviteReset())},X)])])])):u("",!0),!((h=(f=n.$client.space)==null?void 0:f.self)!=null&&h.isOwner())&&n.$client.space!==void 0?(r(),c("article",Y,[e("div",null,[Z,e("h5",x,"Space » "+l(n.$client.space.name)+" «",1),e("nav",ee,[e("button",{class:"large error",onClick:t[5]||(t[5]=o=>a.leaveSpace())},[ne,e("span",null,l(n.$t("common.leave")),1)])])])])):u("",!0)])):u("",!0)]),$(y),e("div",{class:s(["overlay",{active:i.openSpaceLeaveConfirmDialog}]),onClick:t[6]||(t[6]=o=>i.openSpaceLeaveConfirmDialog=!1)},null,2),e("dialog",{class:s(["error",{active:i.openSpaceLeaveConfirmDialog}])},[e("h5",null,l(n.$t("settings.dialog.leaveSpace.title")),1),e("div",null,l(n.$t("settings.dialog.leaveSpace.message")),1),e("nav",te,[e("button",{class:"error transparent",onClick:t[7]||(t[7]=o=>i.openSpaceLeaveConfirmDialog=!1)},l(n.$t("common.abort")),1),ie,e("button",{class:"error-container no-elevate",onClick:t[8]||(t[8]=o=>{i.openSpaceLeaveConfirmDialog=!1,a.leaveSpace(!0)})},l(n.$t("common.confirm")),1)])],2),e("div",{class:s(["overlay",{active:i.openSignOutConfirmDialog}]),onClick:t[9]||(t[9]=o=>i.openSignOutConfirmDialog=!1)},null,2),e("dialog",{class:s(["error",{active:i.openSignOutConfirmDialog}])},[e("h5",null,l(n.$t("settings.dialog.anonLogOut.title")),1),e("div",null,l(n.$t("settings.dialog.anonLogOut.message")),1),e("nav",le,[e("button",{class:"error transparent",onClick:t[10]||(t[10]=o=>i.openSignOutConfirmDialog=!1)},l(n.$t("common.abort")),1),oe,e("button",{class:"error-container no-elevate",onClick:t[11]||(t[11]=o=>{i.openSignOutConfirmDialog=!1,a.signOut(!0)})},l(n.$t("common.confirm")),1)])],2),e("div",{class:s(["overlay",{active:i.openDeleteAccountConfirmDialog}]),onClick:t[12]||(t[12]=o=>i.openDeleteAccountConfirmDialog=!1)},null,2),e("dialog",{class:s(["error",{active:i.openDeleteAccountConfirmDialog}])},[e("h5",null,l(n.$t("settings.dialog.deleteAccount.title")),1),e("div",null,l(n.$t("settings.dialog.deleteAccount.message")),1),e("nav",se,[e("button",{class:"error transparent",onClick:t[13]||(t[13]=o=>i.openDeleteAccountConfirmDialog=!1)},l(n.$t("common.abort")),1),ae,e("button",{class:"error-container no-elevate",onClick:t[14]||(t[14]=o=>{i.openDeleteAccountConfirmDialog=!1,a.deleteAccount(!0)})},l(n.$t("common.confirm")),1)])],2),e("div",{class:s(["overlay",{active:i.openReauthenticateDialog}]),onClick:t[15]||(t[15]=o=>i.openReauthenticateDialog=!1)},null,2),e("dialog",{class:s(["error",{active:i.openReauthenticateDialog}])},[e("h5",null,l(n.$t("settings.dialog.relogin.title")),1),e("div",null,l(n.$t("settings.dialog.relogin.message")),1),e("nav",re,[e("button",{class:"error-container no-elevate",onClick:t[16]||(t[16]=o=>i.openReauthenticateDialog=!1)},l(n.$t("common.ok")),1)])],2),e("div",{class:s(["overlay",{active:i.openShareInviteDialog}]),onClick:t[17]||(t[17]=o=>i.openShareInviteDialog=!1)},null,2),e("dialog",{class:s({active:i.openShareInviteDialog})},[e("h5",null,l(n.$t("settings.dialog.invitationLink.title")),1),e("div",null,l(n.$t("settings.dialog.invitationLink.message")),1),ce,e("div",ue,[ve,C(e("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=o=>i.inviteUrl=o)},null,512),[[D,i.inviteUrl]]),e("label",null,l(n.$t("common.invitationLink")),1)]),i.inviteUrl.length>5?(r(),w(S,{key:0,class:"center",value:i.inviteUrl,options:{width:250}},null,8,["value"])):u("",!0),e("nav",ge,[e("button",{class:"no-elevate",onClick:t[19]||(t[19]=o=>i.openShareInviteDialog=!1)},l(n.$t("common.ok")),1)])],2)],64)}const he=L(I,[["render",me]]);export{he as default};
