import{P as A,k as L,l as w,_ as O,c as u,b as k,a as n,r as m,q as v,u as s,t as i,B as y,C as h,y as I,F as R,o as r}from"./index-C51B43mm.js";const B={data(){return{loaded:!1,openSpaceLeaveConfirmDialog:!1,openSignOutConfirmDialog:!1,openDeleteAccountConfirmDialog:!1,openReauthenticateDialog:!1,openShareInviteDialog:!1,form:{name:"",nameTimeout:0},inviteUrl:""}},methods:{async signOut(t=!1){var e;if(!t&&((e=this.$ctx.currentUser.value)!=null&&e.isAnonymous)){this.openSignOutConfirmDialog=!0;return}await this.$ctx.auth.signOut(),window.location.reload()},async deleteAccount(t=!1){if(!t){this.openDeleteAccountConfirmDialog=!0;return}try{await this.$client.deleteAccount()}catch(e){if(e.code=="auth/requires-recent-login"){this.openReauthenticateDialog=!0,await this.$ctx.auth.signOut(),window.location.reload();return}console.error(e)}},invite(){var e;let t=this.$client.space.generateInvite(this.$t);console.info("share data",t),(e=navigator==null?void 0:navigator.share)==null||e.call(navigator,t),this.inviteUrl=this.$client.space.generateInvite(this.$t).url,this.openShareInviteDialog=!0},async inviteReset(){await this.$client.space.resetInvite(),this.inviteUrl=this.$client.space.generateInvite(this.$t).url},leaveSpace(t=!1){if(!t){this.openSpaceLeaveConfirmDialog=!0;return}this.$client.leaveSpace()}},mounted(){var t;this.form.name=((t=this.$client.space)==null?void 0:t.name)||"",(async()=>{var e;for(;((e=this.$client.space)==null?void 0:e.loaded)!=!0;)await w(50);this.loaded=!0})()},watch:{"form.name"(){var t;((t=this.$client.space)==null?void 0:t.name)!=this.form.name&&(clearTimeout(this.form.nameTimeout),this.form.nameTimeout=setTimeout(()=>{this.$client.space.updateName(this.form.name)},1e3))},"$client.space"(){var t;this.form.name=((t=this.$client.space)==null?void 0:t.name)||"",this.inviteUrl=this.$client.space.generateInvite(this.$t).url},inviteUrl(){let t=this.$client.space.generateInvite(this.$t).url;this.inviteUrl!=t&&(this.inviteUrl=t)}},components:{AppBar:L,PrivacyPolicyLink:A}},P={class:"responsive max"},T={key:0,class:"center-align",style:{height:"100%",display:"flex","flex-direction":"column"}},V={class:"medium center middle-align center-align",style:{"min-width":"300px"}},N=["src"],q={class:"center-align"},F={class:"link small-text"},z={class:"center-align"},E={key:0,class:"medium center middle-align center-align"},M={class:"center-align"},j={class:"field label prefix border"},G={class:"center-align"},H={key:1,class:"medium center middle-align center-align"},J={class:"center-align"},K={class:"center-align"},Q={class:"right-align no-space"},W={class:"right-align no-space"},X={class:"right-align no-space"},Y={class:"right-align no-space"},Z={class:"field label prefix border"},x={class:"right-align no-space"};function _(t,e,ee,ne,l,a){var g,c,p,d,f,$,C,D;const S=m("AppBar"),b=m("PrivacyPolicyLink"),U=m("vue-qrcode");return r(),u(R,null,[k(S,{label:t.$t("navigation.settings")},null,8,["label"]),n("main",P,[t.$ctx.currentUser.value!=null?(r(),u("div",T,[n("article",V,[n("div",null,[t.$ctx.currentUser.value.photoURL==null?(r(),u("i",{key:0,class:s([[`${(c=(g=t.$client.space)==null?void 0:g.self)==null?void 0:c.color}-text`],"extra"])},"person",2)):v("",!0),t.$ctx.currentUser.value.photoURL!=null?(r(),u("img",{key:1,class:"circle large",src:t.$ctx.currentUser.value.photoURL,referrerpolicy:"no-referrer"},null,8,N)):v("",!0),n("h5",q,i(t.$t("common.greeting"))+" "+i(((d=(p=t.$client.space)==null?void 0:p.self)==null?void 0:d.name)||(t.$ctx.currentUser.value.isAnonymous?t.$t("common.anon"):t.$ctx.currentUser.value.displayName)),1),n("span",F,i(t.$ctx.currentUser.value.email||t.$ctx.currentUser.value.uid),1),e[23]||(e[23]=n("div",{class:"space"},null,-1)),n("nav",z,[n("button",{class:"large",onClick:e[0]||(e[0]=o=>a.signOut())},[e[21]||(e[21]=n("i",null,"logout",-1)),n("span",null,i(t.$t("common.logOut")),1)]),n("button",{class:"large error",onClick:e[1]||(e[1]=o=>a.deleteAccount())},[e[22]||(e[22]=n("i",null,"delete",-1)),n("span",null,i(t.$t("common.delete")),1)])])])]),l.loaded&&(($=(f=t.$client.space)==null?void 0:f.self)!=null&&$.isOwner())?(r(),u("article",E,[n("div",null,[e[27]||(e[27]=n("i",{class:"extra"},"tune",-1)),n("h5",M,i(t.$t("settings.spaceSettings.title")),1),n("div",j,[e[24]||(e[24]=n("i",null,"label",-1)),y(n("input",{type:"name","onUpdate:modelValue":e[2]||(e[2]=o=>l.form.name=o)},null,512),[[h,l.form.name]]),n("label",null,i(t.$t("common.name")),1)]),n("nav",G,[n("button",{class:"large",onClick:e[3]||(e[3]=o=>a.invite())},[e[25]||(e[25]=n("i",null,"share",-1)),n("span",null,i(t.$t("common.invite")),1)]),n("button",{class:"circle large error",onClick:e[4]||(e[4]=o=>a.inviteReset())},e[26]||(e[26]=[n("i",null,"restore",-1)]))])])])):v("",!0),!((D=(C=t.$client.space)==null?void 0:C.self)!=null&&D.isOwner())&&t.$client.space!==void 0?(r(),u("article",H,[n("div",null,[e[30]||(e[30]=n("i",{class:"extra"},"groups",-1)),n("h5",J,"Space » "+i(t.$client.space.name)+" «",1),n("nav",K,[n("button",{class:"large",onClick:e[5]||(e[5]=o=>a.invite())},[e[28]||(e[28]=n("i",null,"share",-1)),n("span",null,i(t.$t("common.invite")),1)]),n("button",{class:"large error",onClick:e[6]||(e[6]=o=>a.leaveSpace())},[e[29]||(e[29]=n("i",null,"logout",-1)),n("span",null,i(t.$t("common.leave")),1)])])])])):v("",!0)])):v("",!0)]),k(b),n("div",{class:s(["overlay",{active:l.openSpaceLeaveConfirmDialog}]),onClick:e[7]||(e[7]=o=>l.openSpaceLeaveConfirmDialog=!1)},null,2),n("dialog",{class:s(["error",{active:l.openSpaceLeaveConfirmDialog}])},[n("h5",null,i(t.$t("settings.dialog.leaveSpace.title")),1),n("div",null,i(t.$t("settings.dialog.leaveSpace.message")),1),n("nav",Q,[n("button",{class:"error transparent",onClick:e[8]||(e[8]=o=>l.openSpaceLeaveConfirmDialog=!1)},i(t.$t("common.abort")),1),e[31]||(e[31]=n("div",{class:"space"},null,-1)),n("button",{class:"error-container no-elevate",onClick:e[9]||(e[9]=o=>{l.openSpaceLeaveConfirmDialog=!1,a.leaveSpace(!0)})},i(t.$t("common.confirm")),1)])],2),n("div",{class:s(["overlay",{active:l.openSignOutConfirmDialog}]),onClick:e[10]||(e[10]=o=>l.openSignOutConfirmDialog=!1)},null,2),n("dialog",{class:s(["error",{active:l.openSignOutConfirmDialog}])},[n("h5",null,i(t.$t("settings.dialog.anonLogOut.title")),1),n("div",null,i(t.$t("settings.dialog.anonLogOut.message")),1),n("nav",W,[n("button",{class:"error transparent",onClick:e[11]||(e[11]=o=>l.openSignOutConfirmDialog=!1)},i(t.$t("common.abort")),1),e[32]||(e[32]=n("div",{class:"space"},null,-1)),n("button",{class:"error-container no-elevate",onClick:e[12]||(e[12]=o=>{l.openSignOutConfirmDialog=!1,a.signOut(!0)})},i(t.$t("common.confirm")),1)])],2),n("div",{class:s(["overlay",{active:l.openDeleteAccountConfirmDialog}]),onClick:e[13]||(e[13]=o=>l.openDeleteAccountConfirmDialog=!1)},null,2),n("dialog",{class:s(["error",{active:l.openDeleteAccountConfirmDialog}])},[n("h5",null,i(t.$t("settings.dialog.deleteAccount.title")),1),n("div",null,i(t.$t("settings.dialog.deleteAccount.message")),1),n("nav",X,[n("button",{class:"error transparent",onClick:e[14]||(e[14]=o=>l.openDeleteAccountConfirmDialog=!1)},i(t.$t("common.abort")),1),e[33]||(e[33]=n("div",{class:"space"},null,-1)),n("button",{class:"error-container no-elevate",onClick:e[15]||(e[15]=o=>{l.openDeleteAccountConfirmDialog=!1,a.deleteAccount(!0)})},i(t.$t("common.confirm")),1)])],2),n("div",{class:s(["overlay",{active:l.openReauthenticateDialog}]),onClick:e[16]||(e[16]=o=>l.openReauthenticateDialog=!1)},null,2),n("dialog",{class:s(["error",{active:l.openReauthenticateDialog}])},[n("h5",null,i(t.$t("settings.dialog.relogin.title")),1),n("div",null,i(t.$t("settings.dialog.relogin.message")),1),n("nav",Y,[n("button",{class:"error-container no-elevate",onClick:e[17]||(e[17]=o=>l.openReauthenticateDialog=!1)},i(t.$t("common.ok")),1)])],2),n("div",{class:s(["overlay",{active:l.openShareInviteDialog}]),onClick:e[18]||(e[18]=o=>l.openShareInviteDialog=!1)},null,2),n("dialog",{class:s({active:l.openShareInviteDialog})},[n("h5",null,i(t.$t("settings.dialog.invitationLink.title")),1),n("div",null,i(t.$t("settings.dialog.invitationLink.message")),1),e[35]||(e[35]=n("div",{class:"space"},null,-1)),n("div",Z,[e[34]||(e[34]=n("i",null,"link",-1)),y(n("input",{type:"text","onUpdate:modelValue":e[19]||(e[19]=o=>l.inviteUrl=o)},null,512),[[h,l.inviteUrl]]),n("label",null,i(t.$t("common.invitationLink")),1)]),l.inviteUrl.length>5?(r(),I(U,{key:0,class:"center",value:l.inviteUrl,options:{width:250}},null,8,["value"])):v("",!0),n("nav",x,[n("button",{class:"no-elevate",onClick:e[20]||(e[20]=o=>l.openShareInviteDialog=!1)},i(t.$t("common.ok")),1)])],2)],64)}const le=O(B,[["render",_]]);export{le as default};
